machine:
  node:
    version: 4.1.0
  ruby:
    version: 2.3.1
  environment:


dependencies:
  override:
    - bundle check --path=vendor/bundle || bundle install --path=vendor/bundle --jobs=4 --retry=3
    - npm prune
    - npm install

  prod:
    branch: prod
    commands:
      - git push https://git.heroku.com/spoilerfreebooks.git
      - heroku run rake db:migrate --app minaret-prod-nuvi:
          timeout: 400 # if your deploys take a long time

test:
  post:
    - bundle exec rake rubocop
    - npm run build
